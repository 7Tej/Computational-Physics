from numpy import *
from scipy.integrate import solve_ivp
from matplotlib.pyplot import *

# Defining the function representing for dy/dt = f(t, y)
def func(t, y):
    return 1-(t-y)**2

# Defining the initial condition y(0)
y0 = 1

t_span = (2,3)
t=arange(2, 3.01, 0.01)
#Using Mathematica
y_exact = array([1., 0.999899, 0.999592, 0.999073, 0.998334, 0.997369, 0.996171, 
0.994732, 0.993045, 0.991101, 0.988891, 0.986407, 0.983639, 0.980577, 0.977212, 0.973533, 0.969527, 0.965185, 0.960492, 0.955437, 0.950005, 0.944183, 0.937955, 0.931305, 0.924218, 0.916674, 0.908657, 0.900146, 
0.891121, 0.881559, 0.871439, 0.860736, 0.849424, 0.837476, 0.824863,0.811554, 0.797516, 0.782716, 0.767115, 0.750676, 0.733354, 0.715107, 0.695886, 0.67564, 0.654313, 0.631848, 0.60818, 0.583241, 0.556959, 0.529254, 0.500041, 0.469228, 0.436714, 0.402391, 0.366142, 0.327837, 0.287336, 0.244487, 0.199121, 0.151055, 0.100085, 0.0459897, -0.0114791, -0.0725945, -0.13766, -0.207015, -0.281037, -0.360151, -0.444834, -0.535625, -0.633134, -0.738057, -0.851187, -0.973436, -1.10586, -1.24967, -1.4063, -1.57741, -1.76499, -1.97138, -2.1994, -2.45247, -2.73477, -3.05144, -3.40893, -3.81541, -4.28136, -4.82051, -5.45114, -6.19819, -7.09657, -8.19668, -9.57412, -11.3476, -13.715, -17.0322, -22.0101, -30.3054, -46.8748, -96.3295, -7564.48])


def num_sol(t_span,y0,t_eval):
    sol = solve_ivp(func, t_span, [y0], t_eval=t_eval)
    return sol.t, sol.y[0]
    
t_, y = num_sol(t_span,y0,t_eval)

# Plotting the solution
plot(t_, y, label='solve_ivp( )')
plot(t, y_exact,'r:', label='Mathematica')
xlabel(r't$\rightarrow$')
ylabel(r'y$\rightarrow$')
title(r"Solution of $y'=1-(t-y)^2$")

legend()
grid(True)
show()
